<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Quiz Renderer - Bar Chart Ordering</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .result { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .chart-container { margin: 20px 0; }
        canvas { max-width: 600px; height: 400px; }
    </style>
</head>
<body>
    <h1>Bar Chart Ordering Test</h1>
    <p>Testing the updated JSON data structure for U1-PC-MCQ-A-Q11</p>
    <div id="results"></div>
    <div id="chart-container" class="chart-container"></div>
    
    <script>
        async function testBarChart() {
            const resultsDiv = document.getElementById('results');
            
            try {
                // Load the JSON file
                const response = await fetch('assets/jsons/u1_mcq_part_a.json');
                const data = await response.json();
                
                // Find the specific question
                const question = data.find(q => q.id === 'U1-PC-MCQ-A-Q11');
                
                if (!question) {
                    resultsDiv.innerHTML += `<div class="result error">✗ Question U1-PC-MCQ-A-Q11 not found</div>`;
                    return;
                }
                
                resultsDiv.innerHTML += `<div class="result success">✓ Found question U1-PC-MCQ-A-Q11</div>`;
                
                // Check the data structure
                const attachments = question.attachments;
                resultsDiv.innerHTML += `<div class="result success">✓ Y-Labels: ${JSON.stringify(attachments.yLabels)}</div>`;
                resultsDiv.innerHTML += `<div class="result success">✓ Series Order: ${attachments.series.map(s => s.name).join(', ')}</div>`;
                resultsDiv.innerHTML += `<div class="result success">✓ Grade 8 values: ${JSON.stringify(attachments.series[0].values)}</div>`;
                resultsDiv.innerHTML += `<div class="result success">✓ Grade 7 values: ${JSON.stringify(attachments.series[1].values)}</div>`;
                
                // Create chart
                const canvas = document.createElement('canvas');
                canvas.id = 'test-chart';
                document.getElementById('chart-container').appendChild(canvas);
                
                const ctx = canvas.getContext('2d');
                
                // Create the chart using the JSON data
                const chartData = {
                    labels: attachments.yLabels,
                    datasets: attachments.series.map((series, index) => ({
                        label: series.name,
                        data: series.values,
                        backgroundColor: index === 0 ? 'rgba(54, 162, 235, 0.8)' : 'rgba(255, 99, 132, 0.8)',
                        borderColor: index === 0 ? 'rgba(54, 162, 235, 1)' : 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }))
                };
                
                const config = {
                    type: 'bar',
                    data: chartData,
                    options: {
                        indexAxis: 'y', // This makes it horizontal
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Updated Bar Chart - Should match grayscale reference'
                            },
                            legend: {
                                display: true
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 60,
                                ticks: {
                                    stepSize: 10
                                },
                                title: {
                                    display: true,
                                    text: 'Number of Students'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'School Subject'
                                }
                            }
                        }
                    }
                };
                
                new Chart(ctx, config);
                
                resultsDiv.innerHTML += `<div class="result success">✓ Chart rendered successfully</div>`;
                
                // Show expected ordering
                resultsDiv.innerHTML += `<div class="result success">✓ Expected: Art at top, Language Arts at bottom</div>`;
                resultsDiv.innerHTML += `<div class="result success">✓ Expected: Grade 8 (blue) bars in front, Grade 7 (red) bars behind</div>`;
                
            } catch (error) {
                resultsDiv.innerHTML += `<div class="result error">✗ Error: ${error.message}</div>`;
            }
        }
        
        // Run the test when page loads
        testBarChart();
    </script>
</body>
</html> 